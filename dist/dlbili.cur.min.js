/*! dlbili.cur.js v0.1.0 | MIT License | github.com/cnily03/bili-download */
const dlbiliCur=async e=>{const n=e,a=window.bvid,r=window.cid;var t=window.p+1;const o=window.j;await o("https://cdn.jsdelivr.net/gh/Stuk/jszip@3.7.1/dist/jszip.min.js");var i=[];await new Promise(t=>{$.ajax({url:`https://api.bilibili.com/x/player/playurl?cid=${r}&${n}&bvid=`+a,type:"GET",dataType:"json",success:e=>{t(e.data.durl)}})}).then(e=>{e.forEach(e=>{i.push(e.url)})});e=document.querySelector(".video-title.tit").innerText.replace(/[\u002a\u002e\u003f\u0022\u003c\u003e\u007c\u002f\u005c]/g,"_");(async(e,t,r)=>{const o=(e=>{e=e.replace(/\?.*/,"").split(".");return"."+e[e.length-1]})(e[0]),n=window.URL||window.webkitURL||window;var a=document.createElementNS("http://www.w3.org/1999/xhtml","a");var i,e=await(async t=>{var n=[];for(let e=0;e<t.length;e++)try{var a=await(n=>new Promise(e=>{let t=new XMLHttpRequest;t.open("GET",n,!0),t.responseType="blob",t.onload=()=>{200===t.status&&e(t.response)},t.send()}))(t[e]);n.push({name:r+" "+e.toString().padStart(t.length.toString().length,"0")+o,blob:new Blob([a])})}catch(e){}return n})(e);e.length-1?(i=new JSZip,e.forEach(e=>{e&&i.file(e.name,e.blob)}),i.generateAsync({type:"blob"}).then(e=>{a.href=n.createObjectURL(e),a.download=t,a.click(),n.revokeObjectURL(a.href)})):e.length?(a.href=n.createObjectURL(e[0].blob),a.download=t+o,a.click(),n.revokeObjectURL(a.href)):alert("\u4e0b\u8f7d\u5931\u8d25\uff01")})(i,a+`_p${t} `+e,e+"_p"+t),alert("\u5df2\u53d1\u9001\u4e0b\u8f7d\uff01\u8bf7\u7b49\u5f85\u540e\u53f0\u4e0b\u8f7d\u5b8c\u6210\u3002")};window.dlbCur=!0;