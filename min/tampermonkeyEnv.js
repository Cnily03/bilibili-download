const _default={ConfigCookie:{globalOptions:{crypto:!1,maxAge:2592e3,domain:window.encodeURIComponent(window.location.hostname),path:window.decodeURI(window.location.pathname)},cryptoOptions:{encrypto:e=>window.btoa(window.encodeURIComponent(e)),decrypto:e=>window.decodeURIComponent(window.atob(e))}}};class ConfigCookie{constructor(e,o){o=ConfigCookie.defaultify(o,_default.ConfigCookie.globalOptions),this.COOKIE_NAME=e,this.OPTIONS={MAX_AGE:o.maxAge,DOMAIN:o.domain,PATH:o.path},"boolean"==typeof o.crypto?(this.IS_CRYPTO=o.crypto,this.CRYPTO_INFO=JSON.parse(JSON.stringify(_default.ConfigCookie.cryptoOptions))):"object"==typeof o.crypto&&(this.IS_CRYPTO=!0,this.CRYPTO_INFO=o.crypto)}static defaultify(o,t){"object"!=typeof o&&(o={});const e=Object.keys(t);return e.forEach(e=>{"object"==typeof t[e]?o[e]=this.defaultify(o[e],t[e]):o[e]=o[e]||t[e]}),o}autoEncrypto(e){return this.IS_CRYPTO?this.CRYPTO_INFO.encrypto(e):e}autoDecrypto(e){return this.IS_CRYPTO?this.CRYPTO_INFO.decrypto(e):e}jsonVal(){for(var e=document.cookie.split(";"),o=0;o<e.length;o++){var t=e[o].split("=");if(this.COOKIE_NAME==t[0].trim())return JSON.parse(this.autoDecrypto(t[1]))}return{}}saveCookie(e,o=!1){document.cookie=`${this.COOKIE_NAME}=${this.autoEncrypto(JSON.stringify(e))}; `+`max-age=${o?"0":this.OPTIONS.MAX_AGE.toString()}; `+`domain=${this.OPTIONS.DOMAIN}; `+"path="+this.OPTIONS.PATH,o||Object.keys(e).length||this.delCookie()}delCookie(){this.saveCookie({},!0)}get(e){var o=this.jsonVal();return Object.keys(o).length||this.delCookie(),o[e]}set(e,o){let t=this.jsonVal();return t[e]=o,this.saveCookie(t),o}remove(e){let o=this.jsonVal();return delete o[e],this.saveCookie(o),!0}}class TampermonkeyPlugin{constructor(e,o,t){this.PLUGIN_NAME=e="Tampermonkey."+e.replace(/ /g,"-"),this.CONFIG_COOKIE=new ConfigCookie(e,t),window.unsafeWindow=window,window.GM_info=o,window.GM_getValue=e=>this.CONFIG_COOKIE.get(e),window.GM_setValue=(e,o)=>this.CONFIG_COOKIE.set(e,o),window.GM_setClipboard=(o,t)=>{"text"==t&&(t="text/plain");var e=e=>{e.clipboardData.setData(t,o),e.preventDefault()};document.addEventListener("copy",e);try{document.execCommand("copy")}catch(e){alert("\u4f60\u7684\u6d4f\u89c8\u5668\u4e0d\u652f\u6301\u590d\u5236\uff0c\u8bf7\u5b89\u88c5 Tampermonkey \u63d2\u4ef6\u4f7f\u7528 Bilibili Evolved.")}document.removeEventListener("copy",e)},window.GM_xmlhttpRequest=e=>{e.onload=e.onload||(()=>{}),e.onerror=e.onerror||(()=>{}),e.method=e.method||"get",e.data=e.data||void 0,e.contentType=e.contentType||"application/x-www-form-urlencoded",e.responseType=e.responseType||"text";const o=new XMLHttpRequest;return o.open(e.method,e.url,!0),o.responseType=e.responseType,o.setRequestHeader("Content-Type",e.contentType),o.onload=()=>e.onload(o),o.onerror=()=>e.onerror(o),o.send(e.data),o}}}