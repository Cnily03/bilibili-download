/*! tampermonkeyEnv.js v0.1.0 | MIT License | github.com/cnily03/bili-download */
window.unsafeWindow=window;class ConfigCookie{constructor(e,t){this.COOKIE_NAME=e,"boolean"==typeof(t="object"==typeof t?t:{}).crypto?(this.IS_CRYPTO=t.crypto,this.CRYPTO_INFO={}):"object"==typeof t.crypto?(this.IS_CRYPTO=!0,this.CRYPTO_INFO=t.crypto):(this.IS_CRYPTO=!1,this.CRYPTO_INFO={}),this.OPTIONS={MAX_AGE:t.maxAge||2592e3,DOMAIN:t.domain||window.location.hostname,PATH:t.path||escape(window.location.pathname)}}static encrypto(e,t=0){return window.btoa(window.encodeURIComponent(e))}static decrypto(e,t=0){return window.decodeURIComponent(window.atob(e))}autoEncrypto(e){return this.IS_CRYPTO?ConfigCookie.encrypto(e):e}autoDecrypto(e){return this.IS_CRYPTO?ConfigCookie.decrypto(e):e}jsonVal(){for(var e=document.cookie.split(";"),t=0;t<e.length;t++){var o=e[t].split("=");if(this.COOKIE_NAME==o[0].trim())return JSON.parse(this.autoDecrypto(o[1]),!0)}return{}}saveCookie(e,t=!1){document.cookie=`${this.COOKIE_NAME}=${""===e?"":this.autoEncrypto(JSON.stringify(e),!0)}; `+`max-age=${t?"0":this.OPTIONS.MAX_AGE.toString()}; `+`domain=${this.OPTIONS.DOMAIN}; `+"path="+this.OPTIONS.PATH,t||Object.keys(e).length||this.delCookie()}delCookie(){this.saveCookie({},!0)}get(e){var t=this.jsonVal();return Object.keys(t).length||this.delCookie(),t[e]}set(e,t){let o=this.jsonVal();return o[e]=t,this.saveCookie(o),t}remove(e){let t=this.jsonVal();return delete t[e],this.saveCookie(t),!0}}var valSave={add:e=>{e="Tampermonkey."+e.replace(/ /g,"-"),valSave[e]=new ConfigCookie(e,{domain:"bilibili.com",path:"/"})},remove:e=>{delete valSave[e]}};valSave.add("Bilibili-Evolved"),window.GM_getValue=e=>window.valSave["Bilibili-Evolved"].get(e),window.GM_setValue=(e,t)=>window.valSave["Bilibili-Evolved"].set(e,t),window.GM_setClipboard=(t,o)=>{"text"==o&&(o="text/plain");var e=e=>{e.clipboardData.setData(o,t),e.preventDefault()};document.addEventListener("copy",e);try{document.execCommand("copy")}catch(e){alert("\u4f60\u7684\u6d4f\u89c8\u5668\u4e0d\u652f\u6301\u590d\u5236\uff0c\u8bf7\u5b89\u88c5 Tampermonkey \u63d2\u4ef6\u4f7f\u7528 Bilibili Evolved.")}document.removeEventListener("copy",e)},window.GM_xmlhttpRequest=e=>{const t=new XMLHttpRequest;t.open(e.method,e.url,!0),t.responseType=e.responseType||"text",t.setRequestHeader("Content-Type",e.contentType||"application/x-www-form-urlencoded"),t.onload=()=>e.onload(t),t.onerror=()=>e.onerror(t),t.send(e.data||null)};